(function(){var a,b=function(a,b){return function(){return a.apply(b,arguments)}};a=pimatic.tryCatch,$(document).on("pagebeforecreate","#devicepages-page",a(function(){var c,d;return c=function(){function c(){this.onEditDevicepageClicked=b(this.onEditDevicepageClicked,this),this.onAddDevicepageClicked=b(this.onAddDevicepageClicked,this),this.onDevicepagesSorted=b(this.onDevicepagesSorted,this),this.devicepages=pimatic.devicepages,this.devicepagesListViewRefresh=ko.computed(a(function(a){return function(){return a.devicepages(),a.isSortingDevicepages(),a.enabledEditing(),pimatic["try"](function(){return $("#devicepages").listview("refresh").addClass("dark-background")})}}(this))).extend({rateLimit:{timeout:1,method:"notifyWhenChangesStop"}}),this.lockButton=ko.computed(a(function(a){return function(){var b;return b=a.enabledEditing(),{icon:b?"check":"gear"}}}(this)))}return c.prototype.enabledEditing=ko.observable(!1),c.prototype.isSortingDevicepages=ko.observable(!1),c.prototype.afterRenderDevicepage=function(a){var b;return b=$("#sortable-handle-template").text(),$(a).find("a").before($(b))},c.prototype.toggleEditing=function(){return this.enabledEditing(!this.enabledEditing())},c.prototype.onDevicepagesSorted=function(a,b){var c,d,e,f,g;for(d=[],null==b&&d.push(a.id),g=this.devicepages(),e=0,f=g.length;f>e;e++)c=g[e],c!==a&&(d.push(c.id),null!=b&&c===b&&d.push(a.id));return pimatic.client.rest.updatePageOrder({pageOrder:d}).done(ajaxShowToast).fail(ajaxAlertFail)},c.prototype.onDropDevicepageOnTrash=function(a){var b,c;return c=confirm(__("Do you really want to delete the %s devicepage?",a.name())),c?(b=function(){return function(){return pimatic.loading("deletedevicepage","show",{text:__("Saving")}),pimatic.client.rest.removePage({pageId:a.id}).always(function(){return pimatic.loading("deletedevicepage","hide")}).done(ajaxShowToast).fail(ajaxAlertFail)}}(this))():void 0},c.prototype.onAddDevicepageClicked=function(){return pimatic.pages.editDevicepage.resetFields(),pimatic.pages.editDevicepage.action("add"),!0},c.prototype.onEditDevicepageClicked=function(a){return pimatic.pages.editDevicepage.pageId(a.id),pimatic.pages.editDevicepage.pageName(a.name()),pimatic.pages.editDevicepage.action("update"),jQuery.mobile.changePage("#edit-devicepage"),!0},c}(),pimatic.pages.devicepages=d=new c})),$(document).on("pagecreate","#devicepages-page",a(function(){var a,b,c;a=pimatic.pages.devicepages;try{ko.applyBindings(a,$("#devicepages-page")[0])}catch(d){b=d,TraceKit.report(b),null!=(c=pimatic.storage)&&c.removeAll(),window.location.reload()}$("#devicepages .handle").disableSelection()})),$(document).on("pagebeforeshow","#devicepages-page",a(function(){return pimatic["try"](function(){return function(){return $("#devicepages").listview("refresh").addClass("dark-background")}}(this))}))}).call(this);